function ddq = fwdDyn(q, dq, tau, he)
%vpa(simplify(myRobot.setValues(myRobot.fwdDynDdq)),4) 
q1 = q(1);q2 = q(2);q3 = q(3);
dq1 = dq(1);dq2 = dq(2);dq3 = dq(3);
fex = he(1);fey = he(2);fez = he(3);
uex = he(4);uey = he(5);uez = he(6);
tau1 = tau(1);tau2 = tau(2);tau3 = tau(3);

% ddq = [ 
% ((tau1 - 1.0*fey + cos(q2)*(0.09*sin(q2)*dq2^2 + fey) + fey*cos(q2) + sin(q2)*(0.06*dq2^2 - 1.0*fex + 0.09*dq2^2*cos(q2)) - 1.0*fex*sin(q2))*(0.3793*fez + 1.2*uez - 0.0432*cos(q2) + 0.324*fez*sin(q2)^2 - 0.0324*cos(q2)^2 - 0.0324*sin(q2)^2 + 0.36*fey*cos(q2) + 0.432*fez*cos(q2) + 0.36*fex*sin(q2) + 0.324*fez*cos(q2)^2 - 0.03793))/(0.1138*fez + 0.36*uez - 0.01296*cos(q2) + 0.252*uez*cos(q2)^2 + 0.211*fez*sin(q2)^2 + 0.468*uez*sin(q2)^2 - 0.01678*cos(q2)^2 - 0.0211*sin(q2)^2 - 0.02592*cos(q2)*sin(q2)^2 + 0.1459*fey*cos(q2) + 0.1296*fez*cos(q2) - 0.072*uez*cos(q2) + 0.07007*fex*sin(q2) - 0.03888*cos(q2)^2*sin(q2)^2 - 0.0504*fey*cos(q2)^2 + 0.1678*fez*cos(q2)^2 + 0.3888*fez*cos(q2)^2*sin(q2)^2 + 0.0072*fex*cos(q2)*sin(q2) + 0.1512*fex*cos(q2)^2*sin(q2) + 0.2808*fey*cos(q2)*sin(q2)^2 + 0.2592*fez*cos(q2)*sin(q2)^2 - 0.01138) + ((fez + tau3 - 0.98)*(1.08*uez*cos(q2)^2 - 1.08*uez*sin(q2)^2 - 0.3793*fey*cos(q2) + 0.72*uez*cos(q2) + 0.3793*fex*sin(q2) - 0.216*fey*cos(q2)^2 + 0.648*fex*cos(q2)*sin(q2) + 0.648*fex*cos(q2)^2*sin(q2) - 0.648*fey*cos(q2)*sin(q2)^2))/(0.1138*fez + 0.36*uez - 0.01296*cos(q2) + 0.252*uez*cos(q2)^2 + 0.211*fez*sin(q2)^2 + 0.468*uez*sin(q2)^2 - 0.01678*cos(q2)^2 - 0.0211*sin(q2)^2 - 0.02592*cos(q2)*sin(q2)^2 + 0.1459*fey*cos(q2) + 0.1296*fez*cos(q2) - 0.072*uez*cos(q2) + 0.07007*fex*sin(q2) - 0.03888*cos(q2)^2*sin(q2)^2 - 0.0504*fey*cos(q2)^2 + 0.1678*fez*cos(q2)^2 + 0.3888*fez*cos(q2)^2*sin(q2)^2 + 0.0072*fex*cos(q2)*sin(q2) + 0.1512*fex*cos(q2)^2*sin(q2) + 0.2808*fey*cos(q2)*sin(q2)^2 + 0.2592*fez*cos(q2)*sin(q2)^2 - 0.01138) + (12.0*(0.006*cos(q2) + 0.09*fez*sin(q2)^2 + 0.009*cos(q2)^2 - 0.009*sin(q2)^2 - 0.1*fey*cos(q2) - 0.06*fez*cos(q2) + 0.1*fex*sin(q2) - 0.09*fez*cos(q2)^2)*(tau2 - 0.6*fey + uez - 0.009*dq2^2*sin(q2) - 0.3*fey*cos(q2) - 0.3*sin(q2)*(0.06*dq2^2 - 1.0*fex + 0.09*dq2^2*cos(q2)) + 0.6*fex*sin(q2) + (0.09*sin(q2)*dq2^2 + fey)*(0.3*cos(q2) + 0.3) + fey*(0.3*cos(q2) + 0.3)))/(0.1138*fez + 0.36*uez - 0.01296*cos(q2) + 0.252*uez*cos(q2)^2 + 0.211*fez*sin(q2)^2 + 0.468*uez*sin(q2)^2 - 0.01678*cos(q2)^2 - 0.0211*sin(q2)^2 - 0.02592*cos(q2)*sin(q2)^2 + 0.1459*fey*cos(q2) + 0.1296*fez*cos(q2) - 0.072*uez*cos(q2) + 0.07007*fex*sin(q2) - 0.03888*cos(q2)^2*sin(q2)^2 - 0.0504*fey*cos(q2)^2 + 0.1678*fez*cos(q2)^2 + 0.3888*fez*cos(q2)^2*sin(q2)^2 + 0.0072*fex*cos(q2)*sin(q2) + 0.1512*fex*cos(q2)^2*sin(q2) + 0.2808*fey*cos(q2)*sin(q2)^2 + 0.2592*fez*cos(q2)*sin(q2)^2 - 0.01138)
%                                                             (12.0*(0.3*fez + 0.3*fez*sin(q2)^2 - 0.03*cos(q2)^2 - 0.03*sin(q2)^2 + 0.1*fey*cos(q2) - 0.1*fex*sin(q2) + 0.3*fez*cos(q2)^2 - 0.03)*(tau2 - 0.6*fey + uez - 0.009*dq2^2*sin(q2) - 0.3*fey*cos(q2) - 0.3*sin(q2)*(0.06*dq2^2 - 1.0*fex + 0.09*dq2^2*cos(q2)) + 0.6*fex*sin(q2) + (0.09*sin(q2)*dq2^2 + fey)*(0.3*cos(q2) + 0.3) + fey*(0.3*cos(q2) + 0.3)))/(0.1138*fez + 0.36*uez - 0.01296*cos(q2) + 0.252*uez*cos(q2)^2 + 0.211*fez*sin(q2)^2 + 0.468*uez*sin(q2)^2 - 0.01678*cos(q2)^2 - 0.0211*sin(q2)^2 - 0.02592*cos(q2)*sin(q2)^2 + 0.1459*fey*cos(q2) + 0.1296*fez*cos(q2) - 0.072*uez*cos(q2) + 0.07007*fex*sin(q2) - 0.03888*cos(q2)^2*sin(q2)^2 - 0.0504*fey*cos(q2)^2 + 0.1678*fez*cos(q2)^2 + 0.3888*fez*cos(q2)^2*sin(q2)^2 + 0.0072*fex*cos(q2)*sin(q2) + 0.1512*fex*cos(q2)^2*sin(q2) + 0.2808*fey*cos(q2)*sin(q2)^2 + 0.2592*fez*cos(q2)*sin(q2)^2 - 0.01138) - (12.0*(fez + tau3 - 0.98)*(0.3*uez + 0.3*uez*cos(q2)^2 + 0.3*uez*sin(q2)^2 + 0.09*fey*cos(q2) + 0.09*fex*sin(q2) - 0.06*fey*cos(q2)^2 + 0.06*fex*cos(q2)*sin(q2) + 0.18*fex*cos(q2)^2*sin(q2) + 0.18*fey*cos(q2)*sin(q2)^2))/(0.1138*fez + 0.36*uez - 0.01296*cos(q2) + 0.252*uez*cos(q2)^2 + 0.211*fez*sin(q2)^2 + 0.468*uez*sin(q2)^2 - 0.01678*cos(q2)^2 - 0.0211*sin(q2)^2 - 0.02592*cos(q2)*sin(q2)^2 + 0.1459*fey*cos(q2) + 0.1296*fez*cos(q2) - 0.072*uez*cos(q2) + 0.07007*fex*sin(q2) - 0.03888*cos(q2)^2*sin(q2)^2 - 0.0504*fey*cos(q2)^2 + 0.1678*fez*cos(q2)^2 + 0.3888*fez*cos(q2)^2*sin(q2)^2 + 0.0072*fex*cos(q2)*sin(q2) + 0.1512*fex*cos(q2)^2*sin(q2) + 0.2808*fey*cos(q2)*sin(q2)^2 + 0.2592*fez*cos(q2)*sin(q2)^2 - 0.01138) - (12.0*(tau1 - 1.0*fey + cos(q2)*(0.09*sin(q2)*dq2^2 + fey) + fey*cos(q2) + sin(q2)*(0.06*dq2^2 - 1.0*fex + 0.09*dq2^2*cos(q2)) - 1.0*fex*sin(q2))*(0.1*uez - 0.006*cos(q2) - 0.09*fez*sin(q2)^2 - 0.009*cos(q2)^2 + 0.009*sin(q2)^2 + 0.03*fey*cos(q2) + 0.06*fez*cos(q2) + 0.03*fex*sin(q2) + 0.09*fez*cos(q2)^2))/(0.1138*fez + 0.36*uez - 0.01296*cos(q2) + 0.252*uez*cos(q2)^2 + 0.211*fez*sin(q2)^2 + 0.468*uez*sin(q2)^2 - 0.01678*cos(q2)^2 - 0.0211*sin(q2)^2 - 0.02592*cos(q2)*sin(q2)^2 + 0.1459*fey*cos(q2) + 0.1296*fez*cos(q2) - 0.072*uez*cos(q2) + 0.07007*fex*sin(q2) - 0.03888*cos(q2)^2*sin(q2)^2 - 0.0504*fey*cos(q2)^2 + 0.1678*fez*cos(q2)^2 + 0.3888*fez*cos(q2)^2*sin(q2)^2 + 0.0072*fex*cos(q2)*sin(q2) + 0.1512*fex*cos(q2)^2*sin(q2) + 0.2808*fey*cos(q2)*sin(q2)^2 + 0.2592*fez*cos(q2)*sin(q2)^2 - 0.01138)
%                                                            ((fez + tau3 - 0.98)*(3.6*uez - 0.1296*cos(q2) + 2.52*uez*cos(q2)^2 + 4.68*uez*sin(q2)^2 - 0.1678*cos(q2)^2 - 0.211*sin(q2)^2 - 0.2592*cos(q2)*sin(q2)^2 + 1.459*fey*cos(q2) - 0.72*uez*cos(q2) + 0.7007*fex*sin(q2) - 0.3888*cos(q2)^2*sin(q2)^2 - 0.504*fey*cos(q2)^2 + 0.072*fex*cos(q2)*sin(q2) + 1.512*fex*cos(q2)^2*sin(q2) + 2.808*fey*cos(q2)*sin(q2)^2 - 0.1138))/(0.1138*fez + 0.36*uez - 0.01296*cos(q2) + 0.252*uez*cos(q2)^2 + 0.211*fez*sin(q2)^2 + 0.468*uez*sin(q2)^2 - 0.01678*cos(q2)^2 - 0.0211*sin(q2)^2 - 0.02592*cos(q2)*sin(q2)^2 + 0.1459*fey*cos(q2) + 0.1296*fez*cos(q2) - 0.072*uez*cos(q2) + 0.07007*fex*sin(q2) - 0.03888*cos(q2)^2*sin(q2)^2 - 0.0504*fey*cos(q2)^2 + 0.1678*fez*cos(q2)^2 + 0.3888*fez*cos(q2)^2*sin(q2)^2 + 0.0072*fex*cos(q2)*sin(q2) + 0.1512*fex*cos(q2)^2*sin(q2) + 0.2808*fey*cos(q2)*sin(q2)^2 + 0.2592*fez*cos(q2)*sin(q2)^2 - 0.01138) - (12.0*(0.3*fez + 0.39*fez*sin(q2)^2 - 0.06*fez*cos(q2) + 0.21*fez*cos(q2)^2)*(tau2 - 0.6*fey + uez - 0.009*dq2^2*sin(q2) - 0.3*fey*cos(q2) - 0.3*sin(q2)*(0.06*dq2^2 - 1.0*fex + 0.09*dq2^2*cos(q2)) + 0.6*fex*sin(q2) + (0.09*sin(q2)*dq2^2 + fey)*(0.3*cos(q2) + 0.3) + fey*(0.3*cos(q2) + 0.3)))/(0.1138*fez + 0.36*uez - 0.01296*cos(q2) + 0.252*uez*cos(q2)^2 + 0.211*fez*sin(q2)^2 + 0.468*uez*sin(q2)^2 - 0.01678*cos(q2)^2 - 0.0211*sin(q2)^2 - 0.02592*cos(q2)*sin(q2)^2 + 0.1459*fey*cos(q2) + 0.1296*fez*cos(q2) - 0.072*uez*cos(q2) + 0.07007*fex*sin(q2) - 0.03888*cos(q2)^2*sin(q2)^2 - 0.0504*fey*cos(q2)^2 + 0.1678*fez*cos(q2)^2 + 0.3888*fez*cos(q2)^2*sin(q2)^2 + 0.0072*fex*cos(q2)*sin(q2) + 0.1512*fex*cos(q2)^2*sin(q2) + 0.2808*fey*cos(q2)*sin(q2)^2 + 0.2592*fez*cos(q2)*sin(q2)^2 - 0.01138) - (1.0*(0.3793*fez + 1.404*fez*sin(q2)^2 - 0.288*fez*cos(q2) - 0.756*fez*cos(q2)^2)*(tau1 - 1.0*fey + cos(q2)*(0.09*sin(q2)*dq2^2 + fey) + fey*cos(q2) + sin(q2)*(0.06*dq2^2 - 1.0*fex + 0.09*dq2^2*cos(q2)) - 1.0*fex*sin(q2)))/(0.1138*fez + 0.36*uez - 0.01296*cos(q2) + 0.252*uez*cos(q2)^2 + 0.211*fez*sin(q2)^2 + 0.468*uez*sin(q2)^2 - 0.01678*cos(q2)^2 - 0.0211*sin(q2)^2 - 0.02592*cos(q2)*sin(q2)^2 + 0.1459*fey*cos(q2) + 0.1296*fez*cos(q2) - 0.072*uez*cos(q2) + 0.07007*fex*sin(q2) - 0.03888*cos(q2)^2*sin(q2)^2 - 0.0504*fey*cos(q2)^2 + 0.1678*fez*cos(q2)^2 + 0.3888*fez*cos(q2)^2*sin(q2)^2 + 0.0072*fex*cos(q2)*sin(q2) + 0.1512*fex*cos(q2)^2*sin(q2) + 0.2808*fey*cos(q2)*sin(q2)^2 + 0.2592*fez*cos(q2)*sin(q2)^2 - 0.01138)
% ];
ddq = [
                                                     2.392*tau1 - 2.392*fey + 2.392*fey*cos(q2) - 2.392*fex*sin(q2)
55.26*tau2 - 16.58*fey - 55.26*tau3 - 16.58*fey*cos(q2) + 33.15*fex*sin(q2) + 55.26*fey*(0.3*cos(q2) + 0.3) + 54.15
16.58*fey - 55.26*tau2 + 65.26*tau3 + 16.58*fey*cos(q2) - 33.15*fex*sin(q2) - 55.26*fey*(0.3*cos(q2) + 0.3) - 63.95 
];

end